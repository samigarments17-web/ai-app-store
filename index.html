<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>app play store</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- AdMob SDK Script -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-app-pub-6560387888716518"
     crossorigin="anonymous"></script>

    <style>
        /* --- Global Design & Styling --- */
        :root {
            --primary-glow: rgba(0, 255, 255, 0.7);
            --secondary-glow: rgba(159, 0, 255, 0.7);
            --gradient-text: linear-gradient(90deg, #ff00ff, #9f00ff, #00ffff);
            --gradient-button: linear-gradient(90deg, #9f00ff, #ff00ff);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            overflow-x: hidden;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0e0e0e;
            color: #f0f0f0;
            background-image: radial-gradient(circle at top left, rgba(159, 0, 255, 0.2), transparent 30%), radial-gradient(circle at bottom right, rgba(0, 255, 255, 0.2), transparent 30%);
            background-attachment: fixed;
            min-height: 100vh;
        }

        .container {
            width: 95%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        h1, h2 {
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }

        .glass-box {
            background: rgba(20, 20, 30, 0.5);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 2rem;
            margin: 2rem auto;
        }

        /* --- Buttons --- */
        .btn {
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            border: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover { transform: scale(1.05); }

        .btn-solid {
            background: var(--gradient-button);
            color: white;
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.4);
        }
        .btn-solid:hover { box-shadow: 0 0 25px rgba(255, 0, 255, 0.6); }

        .btn-outline {
            background: transparent;
            color: var(--primary-glow);
            border: 2px solid var(--primary-glow);
            box-shadow: 0 0 10px var(--primary-glow);
        }
        .btn-outline:hover { box-shadow: 0 0 20px var(--primary-glow); }
        .btn-outline.active { background: var(--primary-glow); color: #0e0e0e; }

        /* --- Forms & Inputs --- */
        .form-group { margin-bottom: 1.5rem; }
        label { display: block; margin-bottom: 0.5rem; color: rgba(255, 255, 255, 0.8); }
        input, textarea, select {
            width: 100%; padding: 12px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px; color: #f0f0f0;
            font-family: 'Poppins', sans-serif; font-size: 1rem;
            transition: box-shadow 0.3s ease, border-color 0.3s ease;
        }
        input:focus, textarea:focus, select:focus {
            outline: none; border-color: var(--primary-glow);
            box-shadow: 0 0 15px var(--primary-glow);
        }
        textarea { min-height: 200px; resize: vertical; }

        /* --- Header --- */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem 0;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .header-left { display: flex; align-items: center; gap: 1rem; }
        .menu-icon { font-size: 2rem; cursor: pointer; user-select: none; }
        header h1 { font-size: 1.8rem; margin: 0; }
        .filters { display: flex; gap: 10px; }
        #search-bar { min-width: 250px; }

        /* --- Side Menu --- */
        #side-menu {
            position: fixed; top: 0; left: 0;
            width: 300px; height: 100%;
            background: rgba(10, 10, 15, 0.8);
            backdrop-filter: blur(15px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            z-index: 2000;
            padding: 2rem;
        }
        #side-menu.open { transform: translateX(0); }
        #side-menu .close-menu {
            position: absolute; top: 1rem; right: 1.5rem;
            font-size: 2rem; cursor: pointer;
        }
        #side-menu h2 { margin-bottom: 2rem; }
        #side-menu ul { list-style: none; }
        #side-menu ul li a {
            display: block;
            color: #f0f0f0; text-decoration: none;
            font-size: 1.2rem; padding: 1rem 0;
            transition: color 0.2s ease;
        }
        #side-menu ul li a:hover { color: var(--primary-glow); }
        #menu-overlay {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1999;
            opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        #menu-overlay.open { opacity: 1; visibility: visible; }
        
        /* --- Main Content Grid --- */
        .page { display: none; }
        .page.active { display: block; }
        
        #item-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .item-card {
            background: rgba(20, 20, 30, 0.5);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
        }
        .item-card:hover { 
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2), 0 0 20px var(--secondary-glow);
        }
        .card-image {
            width: 100%;
            height: 180px;
            background-size: cover;
            background-position: center;
        }
        .card-content { padding: 1rem; flex-grow: 1; display: flex; flex-direction: column; }
        .card-content h3 { color: #fff; margin-bottom: 0.5rem; }
        .card-content .type-badge {
            align-self: flex-start;
            background: var(--primary-glow); color: #0e0e0e;
            padding: 3px 10px; border-radius: 10px;
            font-size: 0.8rem; font-weight: 700; margin-bottom: auto;
        }
        .card-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 1rem; }
        .star-rating .star {
            font-size: 1.5rem;
            color: #555;
            cursor: pointer;
            transition: color 0.2s, transform 0.2s;
        }
        .star-rating .star:hover { transform: scale(1.2); }
        .star-rating .star.rated { color: gold; }


        /* --- Play Modal --- */
        #play-modal {
            position: fixed; top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: #000;
            z-index: 3000;
            display: none;
        }
        #play-modal iframe {
            width: 100%; height: 100%;
            border: none;
        }
        .close-modal {
            position: absolute; top: 15px; right: 25px;
            font-size: 2.5rem; font-weight: 700;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            z-index: 3001;
            text-shadow: 0 0 10px #000;
        }
        .close-modal:hover { color: #fff; }

        /* --- Notification Toast --- */
        #notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(30, 30, 40, 0.9);
            backdrop-filter: blur(10px);
            color: #fff;
            padding: 15px 25px;
            border-radius: 15px;
            border: 1px solid var(--primary-glow);
            box-shadow: 0 0 20px var(--primary-glow);
            z-index: 4000;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
            visibility: hidden;
        }
        #notification-toast.show {
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
        }
        
        /* Ad Container Style */
        .ad-container {
            width: 100%;
            margin-top: 2rem;
            display: flex;
            justify-content: center;
        }

        /* --- NEW: Responsive Design --- */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                align-items: center;
                gap: 1.5rem;
            }

            .header-left {
                width: 100%;
                justify-content: space-between; /* Pushes h1 and menu icon apart */
            }
            
            .header-right { width: 100%; }
            #search-bar { min-width: 100%; }

            .filters {
                justify-content: center;
                flex-wrap: wrap;
                width: 100%;
            }

            #item-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }

            .glass-box {
                padding: 1.5rem;
                margin: 1rem auto;
            }
            
            header h1 { font-size: 1.6rem; }
            h2 { font-size: 1.4rem; }

            #side-menu {
                width: 80vw; /* Use viewport width for better adaptability */
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0.5rem;
            }

            #item-grid {
                /* Single column on very small screens */
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .btn {
                padding: 8px 20px;
                font-size: 0.9rem;
            }

            .card-footer {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.8rem;
            }
            
            .star-rating {
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>

    <div id="menu-overlay"></div>
    <nav id="side-menu">
        <span class="close-menu">&times;</span>
        <h2>Menu</h2>
        <ul>
            <li><a href="#" class="nav-link" data-view="main-view">Home</a></li>
            <li><a href="#" class="nav-link" data-view="profile-view">User Profile</a></li>
            <li><a href="#" class="nav-link" data-view="submission-view">Upload App/Game</a></li>
        </ul>
    </nav>
    
    <div class="container">
        <header>
            <div class="header-left">
                <span class="menu-icon">&#9776;</span>
                <h1>Neon App Hub</h1>
            </div>
            <div class="header-right">
                <input type="search" id="search-bar" placeholder="Search...">
            </div>
            <div class="filters">
                <button class="btn btn-outline active" data-filter="All">All</button>
                <button class="btn btn-outline" data-filter="Game">Games</button>
                <button class="btn btn-outline" data-filter="App">Apps</button>
            </div>
        </header>

        <main>
            <div id="main-view" class="page active">
                <div id="item-grid"></div>
                <!-- Banner Ad container -->
                <div class="ad-container">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-app-pub-6560387888716518"
                         data-ad-slot="6514408934"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                </div>
            </div>

            <div id="profile-view" class="page">
                <div class="glass-box" style="max-width: 600px;">
                    <h2>User Profile</h2>
                    <p style="margin-bottom: 1.5rem; color: #ccc;">This info is saved on your device and used for submissions.</p>
                    <form id="profile-form">
                        <div class="form-group">
                            <label for="user-name">Your Name</label>
                            <input type="text" id="user-name" required>
                        </div>
                        <div class="form-group">
                            <label for="user-email">Your Email</label>
                            <input type="email" id="user-email" required>
                        </div>
                        <button type="submit" class="btn btn-solid">Save Profile</button>
                    </form>
                </div>
            </div>

            <div id="submission-view" class="page">
                <div class="glass-box" style="max-width: 800px;">
                    <h2>Submit an App or Game</h2>
                    <form id="submission-form">
                         <div class="form-group">
                            <label for="html-code">HTML Code</label>
                            <textarea id="html-code" required placeholder="Paste your full HTML document here..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" id="title" required>
                        </div>
                        <div class="form-group">
                            <label for="logo-url">Logo URL</label>
                            <input type="url" id="logo-url" required placeholder="https://example.com/image.png">
                        </div>
                        <div class="form-group">
                            <label for="type">Type</label>
                            <select id="type" required>
                                <option value="Game">Game</option>
                                <option value="App">App</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-solid">Submit for Review</button>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <div id="play-modal">
        <span class="close-modal">&times;</span>
        <iframe id="play-iframe" srcdoc="" sandbox="allow-scripts allow-same-origin"></iframe>
    </div>

    <div id="notification-toast">
        <p id="notification-message"></p>
    </div>


    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        // --- IMPORTANT: ”9æ7”9æ7PASTE YOUR FIREBASE”9æ7”9æ7 CONFIGURATION HERE ---
    const firebaseConfig = {
      apiKey: "AIzaSyC5Ts-3uQj2TIv2U1JnyYWGCQurXD53XWA",
      authDomain: "app-storee-f7d6f.firebaseapp.com",
      databaseURL: "https://app-storee-f7d6f-default-rtdb.firebaseio.com",
      projectId: "app-storee-f7d6f",
      storageBucket: "app-storee-f7d6f.firebasestorage.app",
      messagingSenderId: "1011809082241",
      appId: "1:1011809082241:web:8c4d05f249ed5e5b412680"
    };
        // --- END OF FIREBASE CONFIGURATION ---

        // Initialize default Firebase app for user panel
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // --- AdMob Configuration ---
        const ADMOB_CLIENT = "ca-app-pub-6560387888716518";
        const INTERSTITIAL_AD_UNIT = "8290525038";
        // The banner ad is configured directly in the HTML.

        let interstitialAd = null;
        let itemToPlayAfterAd = null;

        function preloadInterstitialAd() {
            if (window.adsbygoogle && window.adsbygoogle.interstitial) {
                window.adsbygoogle.interstitial.load({
                    client: ADMOB_CLIENT,
                    slot: INTERSTITIAL_AD_UNIT,
                }).then(ad => {
                    interstitialAd = ad;
                    // Listen for the ad close event
                    interstitialAd.addEventListener('dismiss', () => {
                        if (itemToPlayAfterAd) {
                            launchPlayModal(itemToPlayAfterAd);
                            itemToPlayAfterAd = null;
                        }
                        // Preload the next ad
                        preloadInterstitialAd(); 
                    });
                }).catch(err => {
                    console.error("Interstitial ad failed to load:", err);
                });
            } else {
                 console.error("AdMob SDK not ready for interstitial ads.");
            }
        }
        
        // --- Global State & DOM Elements ---
        let allItems = {}; // Store all items from Firebase
        const itemGrid = document.getElementById('item-grid');
        const playModal = document.getElementById('play-modal');
        const playIframe = document.getElementById('play-iframe');
        
        // --- Navigation & View Management ---
        const pages = document.querySelectorAll('.page');
        const navLinks = document.querySelectorAll('.nav-link');
        const menuIcon = document.querySelector('.menu-icon');
        const sideMenu = document.getElementById('side-menu');
        const closeMenu = document.querySelector('.close-menu');
        const menuOverlay = document.getElementById('menu-overlay');

        function showView(viewId) {
            pages.forEach(p => p.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            closeSideMenu();
        }

        function openSideMenu() {
            sideMenu.classList.add('open');
            menuOverlay.classList.add('open');
        }
        function closeSideMenu() {
            sideMenu.classList.remove('open');
            menuOverlay.classList.remove('open');
        }

        navLinks.forEach(link => link.addEventListener('click', (e) => {
            e.preventDefault();
            showView(e.target.dataset.view);
        }));
        menuIcon.addEventListener('click', openSideMenu);
        closeMenu.addEventListener('click', closeSideMenu);
        menuOverlay.addEventListener('click', closeSideMenu);

        // --- User Profile (LocalStorage) ---
        const profileForm = document.getElementById('profile-form');
        const userNameInput = document.getElementById('user-name');
        const userEmailInput = document.getElementById('user-email');

        function loadProfile() {
            const profile = JSON.parse(localStorage.getItem('userProfile'));
            if (profile) {
                userNameInput.value = profile.name;
                userEmailInput.value = profile.email;
                listenForNotifications(profile.email);
            }
        }

        profileForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const profile = {
                name: userNameInput.value,
                email: userEmailInput.value
            };
            localStorage.setItem('userProfile', JSON.stringify(profile));
            alert('Profile saved!');
            listenForNotifications(profile.email);
        });

        // --- App Submission ---
        const submissionForm = document.getElementById('submission-form');
        submissionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const profile = JSON.parse(localStorage.getItem('userProfile'));

            if (!profile || !profile.name || !profile.email) {
                alert('Please set your Name and Email in the User Profile section before submitting.');
                showView('profile-view');
                return;
            }

            const submissionData = {
                htmlCode: document.getElementById('html-code').value,
                title: document.getElementById('title').value,
                logoUrl: document.getElementById('logo-url').value,
                type: document.getElementById('type').value,
                submitterName: profile.name,
                submitterEmail: profile.email,
                submittedAt: firebase.database.ServerValue.TIMESTAMP
            };

            db.ref('pendingSubmissions').push(submissionData)
                .then(() => {
                    alert('Your submission has been sent for review. Thank you!');
                    submissionForm.reset();
                    showView('main-view');
                })
                .catch(err => {
                    alert('An error occurred: ' + err.message);
                });
        });

        // --- Main View: Fetch, Render, Filter ---
        function renderItems(itemsToRender) {
            itemGrid.innerHTML = '';
            if (Object.keys(itemsToRender).length === 0) {
                itemGrid.innerHTML = '<p>No items found.</p>';
                return;
            }

            for (const key in itemsToRender) {
                const item = itemsToRender[key];
                const card = document.createElement('div');
                card.className = 'item-card';
                card.dataset.key = key;

                // Rating calculation
                const rating = (item.ratingCount > 0) ? (item.totalRating / item.ratingCount) : 0;
                let starsHTML = '';
                const hasRated = localStorage.getItem(`rated_${key}`);
                for (let i = 1; i <= 5; i++) {
                    starsHTML += `<span class="star ${i <= rating ? 'rated' : ''}" data-value="${i}" ${hasRated ? 'style="cursor:not-allowed;"' : ''}>&#9733;</span>`;
                }

                card.innerHTML = `
                    <div class="card-image" style="background-image: url('${item.logoUrl}')"></div>
                    <div class="card-content">
                        <h3>${item.title}</h3>
                        <span class="type-badge">${item.type}</span>
                        <div class="card-footer">
                            <div class="star-rating" data-key="${key}">${starsHTML}</div>
                            <button class="btn btn-solid play-btn" data-key="${key}">Play</button>
                        </div>
                    </div>
                `;
                itemGrid.appendChild(card);
            }
        }
        
        function filterAndRender() {
            const searchTerm = document.getElementById('search-bar').value.toLowerCase();
            const activeFilter = document.querySelector('.filters .active').dataset.filter;
            
            const filteredItems = {};
            for (const key in allItems) {
                const item = allItems[key];
                const titleMatch = item.title.toLowerCase().includes(searchTerm);
                const typeMatch = (activeFilter === 'All' || item.type === activeFilter);
                if (titleMatch && typeMatch) {
                    filteredItems[key] = item;
                }
            }
            renderItems(filteredItems);
        }
        
        // Event listeners for filters and search
        document.querySelector('.filters').addEventListener('click', e => {
            if (e.target.tagName === 'BUTTON') {
                document.querySelectorAll('.filters button').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                filterAndRender();
            }
        });
        document.getElementById('search-bar').addEventListener('input', filterAndRender);
        

        db.ref('items').on('value', snapshot => {
            allItems = snapshot.val() || {};
            filterAndRender();
        });

        function launchPlayModal(item) {
             if (item) {
                // Prepend required style for full-screen experience inside iframe
                const iframeContent = `<style>html, body { margin: 0; padding: 0; height: 100vh; width: 100vw; overflow: hidden; } * { box-sizing: border-box; }</style>${item.htmlCode}`;
                playIframe.srcdoc = iframeContent;
                playModal.style.display = 'block';
            }
        }

        // --- Play & Rating Functionality (Event Delegation) ---
        itemGrid.addEventListener('click', e => {
            const target = e.target;
            
            // Play button clicked
            if (target.classList.contains('play-btn')) {
                const key = target.dataset.key;
                const item = allItems[key];
                itemToPlayAfterAd = item; // Store the item to play after the ad

                if (interstitialAd) {
                    interstitialAd.show().catch(err => {
                        console.error("Ad could not be shown, launching content directly.", err);
                        launchPlayModal(itemToPlayAfterAd); // If ad fails to show, play content
                    });
                } else {
                    console.log("Interstitial ad not ready. Launching content directly.");
                    launchPlayModal(itemToPlayAfterAd); // If no ad is loaded, just play
                }
            }

            // Star rating clicked
            if (target.classList.contains('star')) {
                const key = target.parentElement.dataset.key;
                const ratingValue = parseInt(target.dataset.value);
                if (localStorage.getItem(`rated_${key}`)) {
                    return; // Already rated
                }
                
                const itemRef = db.ref('items/' + key);
                itemRef.transaction(item => {
                    if (item) {
                        item.totalRating = (item.totalRating || 0) + ratingValue;
                        item.ratingCount = (item.ratingCount || 0) + 1;
                    }
                    return item;
                }).then(() => {
                    localStorage.setItem(`rated_${key}`, 'true');
                });
            }
        });
        
        document.querySelector('.close-modal').addEventListener('click', () => {
            playModal.style.display = 'none';
            playIframe.srcdoc = ''; // Clear content to stop execution
        });

        // --- Notifications ---
        function sanitizeEmail(email) {
            return email.replace(/[.#$[\]]/g, "_");
        }

        function showNotification(message) {
            const toast = document.getElementById('notification-toast');
            const msgElement = document.getElementById('notification-message');
            msgElement.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 5000);
        }

        function listenForNotifications(email) {
            if(!email) return;
            const sanitized = sanitizeEmail(email);
            const notificationsRef = db.ref('notifications/' + sanitized);
            
            notificationsRef.on('child_added', snapshot => {
                const notification = snapshot.val();
                showNotification(notification.message);
                // Remove notification after showing it
                snapshot.ref.remove();
            });
        }
        
        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            loadProfile();
            // Preload the first interstitial ad
            preloadInterstitialAd(); 
            // Load banner ad
            (adsbygoogle = window.adsbygoogle || []).push({});
        });

    </script>
</body>
</html>